[%# The contents of this file are subject to the Mozilla Public
  # License Version 1.1 (the "License"); you may not use this file
  # except in compliance with the License. You may obtain a copy of
  # the License at http://www.mozilla.org/MPL/
  #
  # Software distributed under the License is distributed on an "AS
  # IS" basis, WITHOUT WARRANTY OF ANY KIND, either express or
  # implied. See the License for the specific language governing
  # rights and limitations under the License.
  #
  # The Original Code is the BMO Bugzilla Extension.
  #
  # The Initial Developer of the Original Code is the Mozilla Foundation
  # Portions created by the Initial Developers are Copyright (C) 2011 the
  # Initial Developer. All Rights Reserved.
  #
  # Contributor(s): David Lawrence <dkl@mozilla.com>
  #%]

[% PROCESS global/variables.none.tmpl %]

[% PROCESS global/header.html.tmpl
   title = "Edit Roadmap"
   javascript_urls = [ 'js/field.js', 'js/util.js' ]
   yui = [ 'autocomplete', 'calendar' ]
   style_urls = [ 'extensions/Roadmap/web/roadmap.css' ]
%]

<h3>Roadmap Information</h3>

<form method="post" action="page.cgi?id=roadmap/list.html" id="roadmap">
<input type="hidden" name="token" value="[% token FILTER none %]">
<input type="hidden" name="old_name" value="[% roadmap.name FILTER html %]">
<input type="hidden" name="action" value="update">

<table class="roadmap-form">

[% PROCESS "admin/roadmap/edit-common.html.tmpl" %]

<tr class="odd">
  <th>Enabled:</th>
  <td>
    <input id="is_active" name="is_active" type="checkbox" value="1" 
           [% 'checked="checked"' IF roadmap.is_active %]>
  </td>
</tr>
</table>

<br>
<input type="submit" value="Submit">

</form>

<h3>Current Milestones</h3>

[% IF roadmap.milestones.size %]
  <table class="roadmap-form">
  <thead>
  <tr class="even">
    <th>Edit Milestone...</th>
    <th>Sortkey</th>
    <th>Deadline</th>
    <th>Query</th>
    <th>Action</th>
  </tr>
  </thead>
  <tbody>
  [% FOREACH milestone = roadmap.milestones %]
    <tr class="[% loop.count % 2 == 0 ? "even" : "odd" %]">
      <td>
        <a href="[% urlbase FILTER none %]page.cgi?id=roadmap/edit-milestone.html&amp;milestone_name=[% milestone.name FILTER url_quote %]&amp;name=[% roadmap.name FILTER url_quote %]">
        [% milestone.name FILTER html %]</a>
      </td>
      <td>[% milestone.sortkey FILTER html %]</td>
      <td>[% milestone.deadline FILTER html %]</td>
      <td style="white-space: nowrap">[% milestone.query FILTER html %]</td>
      <td>
        <a href="[% urlbase FILTER none %]page.cgi?id=roadmap/milestone-confirm-delete.html&amp;milestone_name=[% milestone.name FILTER url_quote %]&amp;name=[% roadmap.name FILTER url_quote %]">
        Delete</a>
      </td>
    </tr>
  [% END %]
  </tbody>
  </table>
[% ELSE %]
  No milestones currently defined.
[% END %]

<p>
  <a href="[% urlbase FILTER none %]page.cgi?id=roadmap/edit-milestone.html&amp;action=new&amp;name=[% roadmap.name FILTER url_quote %]">
  Add</a> a new milestone to roadmap '[% roadmap.name FILTER html %]', or edit other 
  <a href="[% urlbase FILTER none %]page.cgi?id=roadmap/list.html">roadmaps</a>.
</p>

[% PROCESS global/footer.html.tmpl %]
